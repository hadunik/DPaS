# Огромный и страшный код
Снизу описание для людей, которые работают с БД в docker - там есть забавный момент.

Для работы кода, описанного тут необходимо, чтобы в таблице (seats)
появилась дополнительная колонка extra_space типа данных bool и с дефолтным
значением false.

Сделать это можно чем-то вроде:

``` sql
alter table seats
    add extra_space boolean default false not null;
```

Далее запрос в бд становится тревиальным, правда содержит в себе небольшую
кучу inner join. Важные свойства, которые были установлены при работе:
* На одинаковых рейсах (по номеру) всегда одинаковые самолеты
* Цена на один и тот же рейс (по номеру) может зависеть от дня недели
* Сиденья "разной" стоимости содержаться только в эконом классе
* Иногда пассажиру может достаться место повышенной комфортности и без доплаты (в реальном мире оно работает так же),
ибо в самолете в момент начала регистрации могло не остаться других мест



## Если работаете с бд в docker
Так как postgres любит shared memory, а в docker строгие лимиты на него,
то в docker-compose.yaml файл надо добавить свойство, которое описано ниже.
Его же аналог есть и для БД, которая была просто запущена через docker.

```yaml
version: "3.9"

services:
  db:
    image: postgres
    volumes:
      - ./database:/var/lib/postgresql/data
      - ./demo.sql:/demo.sql
    environment:
      - POSTGRES_DB=root
      - POSTGRES_USER=root
      - POSTGRES_PASSWORD=root
    ports: ["5432:5432"]
    networks:
      - postgres
    restart: no
    shm_size: 1G # HERE
```